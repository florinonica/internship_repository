<script>
function myFunction() {
    var x = document.getElementById("comments");
    if (x.style.display === "none") {
        x.style.display = "block";
        $(".btn").html('<span class="glyphicon glyphicon-collapse-up"></span> Hide comments');
    } else {
        x.style.display = "none";
        $(".btn").html('<span class="glyphicon glyphicon-collapse-down"></span> Show comments');
    }
}
</script>

<h3><%= @ticket.title %></h3><br>
<h4><strong>Description</strong></h4>
<div class="row">
  <div class="col-xs-3">
    <%= @ticket.description %>
  </div>
</div>
<br>
<p>
  <% if current_user.id == @ticket.owner_id %>
    <%=link_to 'Delete', [@ticket.project, @ticket], method: :delete,
              data: { confirm: 'Are you sure?' }, :style => 'color:#0079bf; font-size: 15px; font-weight: bold', class: "glyphicon glyphicon-remove"%> |
  <% end %>
  <% if current_user.id == @ticket.owner_id %>
    <%= link_to 'Edit', edit_project_ticket_path(@ticket.project, @ticket), {:style => 'color:#0079bf; font-size: 15px; font-weight: bold', class: "glyphicon glyphicon-edit"} %> 
  <% end %>
</p>
<br>

<h4>Add a comment:</h4>
<%= form_with(model: [ @ticket, @ticket.comments.build ]) do |form| %>
  <p>
    <%= form.hidden_field :commenter, :value => current_user.username %>
  </p>
  <div class="row">
    <div class="col-xs-4">
    <%= form.text_area :body, class: 'form-control' %>
    </div>
  </div>
  <br>
  <p>
    <%= form.submit "Submit", {class: "btn btn-info collapsed"}%>
  </p>
<% end %>

<button class="btn btn-info collapsed" onclick="myFunction()">
  <span class="glyphicon glyphicon-collapse-down"></span> Show comments
</button>

<div id = "comments" style ='display: none;'>
  <h4>Comments</h4>
  <% @ticket.comments.each do |comment| %>
     <%= render comment if (!comment.parent_id.presence && !(comment.body.nil?)) %>
  <% end %>
</div>

<br>
<%= link_to "Back", dashboard_path(@ticket.project), {class: "btn btn-info collapsed"} %>